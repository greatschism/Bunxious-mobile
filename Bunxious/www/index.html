<!DOCTYPE html>
<!--
    Licensed to the Apache Software Foundation (ASF) under one
    or more contributor license agreements.  See the NOTICE file
    distributed with this work for additional information
    regarding copyright ownership.  The ASF licenses this file
    to you under the Apache License, Version 2.0 (the
    "License"); you may not use this file except in compliance
    with the License.  You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing,
    software distributed under the License is distributed on an
    "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
     KIND, either express or implied.  See the License for the
    specific language governing permissions and limitations
    under the License.
-->
<html>
<head>
  <meta charset="utf-8" />
  <meta name="format-detection" content="telephone=no" />
  <meta name="msapplication-tap-highlight" content="no" />
  
  <!-- WARNING: for iOS 7, remove the width=device-width and height=device-height attributes. See https://issues.apache.org/jira/browse/CB-4323 
  width=device-width, height=device-height, -->
  
  <!-- viewport setting has been explicitly set to 320px width in order to retain consistent display across iPhone models-->
  <meta name="viewport" content="user-scalable=no, width=320" />
  
  <link rel="stylesheet" type="text/css" href="css/index.css" />
  <link rel="stylesheet" type="text/css" href="css/bunxiousmenu.css" />
  <link rel="stylesheet" type="text/css" href="css/icons.css" />
  <script type="text/javascript" src="cordova.js"></script>
  <script type="text/javascript" src="js/index.js"></script>
  <script type="text/javascript" src="js/toggle.js"></script>
  <script type="text/javascript" src="js/jquery.js"></script>
  
  <!-- this has been added for a simple solution for more native response to click events -->
  <script type="text/javascript" src="js/jQuery.fastClick.js"></script>
  
  <script type="text/javascript" src="js/simplefunctions.js"></script>
  <title>Hello World</title>

</head>
<body>


<div id="mainview" class="panel" style="position: fixed; width:320px; height:100%; left: 0px; transition: all 0.5s ease-in-out;">
  <div style="height:64px;width: 100%;text-align: center;background-color: #55888f;padding: 20px 0px 0px 0px;">
    <div  class="toggleWrap">
      <img src="img/menu-button.png" id="toggle" class="toggle" style="position: fixed; left: 10px; top: 32px; transition: all 0.5s ease-in-out;" />
    </div>
    <img id="mainlogo" src="img/logo.png" height="42">
  </div>

<!--  <iframe src="http://bunxious.com/user/login/0/" frameborder="0" seamless="seamless" style="width:420px; width:100%; height:100%;"></iframe> -->

  <!-- this is the starting point for the iFrame content.  It lods up the bunxious 'promo' (main) page -->
  <iframe src="http://bunxious.com/" frameborder="0" seamless="seamless" style="width:320px;  height:100%;"></iframe>

</div>
<div id="sidebar" style="position: fixed; background-color:rgba(98, 148, 155, 1.0) ; height: 100%; width: 200px; left: -200px; transition: all 0.5s ease-in-out;">

  <nav class="vertical">
    <div>
      <div width="100%" style="height: 44px;">
        <img id="menulogo" src="img/logo.png"/>
      </div>
      <!-- 
            There were issues with the initial redirect, and the user session retention when logging-in from the promo page.
            As a workaround the URL in the data-dest attribute is used to present a login popup that will work with the other URL's in this menu
      -->
      <div class="nav-item"  data-dest="http://bunxious.com/user/login/0/">Sign-In</div>
      <!-- For our current implementation, the URL of a test user has been hard-coded directly into the 'My Profile' menu item. -->
      <div class="nav-item"  data-dest="http://bunxious.com/user/2190/Stectech">My Profile</div>
      <!-- 
            The following naviagation items are currently inactive. remove the preceeding X in the class to enable them.
            There are two classes used here.  The nav-item-mnu and nav-item classes are handled slightly differently, and the 
            deatils will be described in comments in the relative JS portion of the code.  The data-dest attribute is used to
            specify the URL which the iFrame will be directed to load.
      -->
      <div class="Xnav-item-mnu"  data-dest="http://bunxious.com/store/address">My Addresses</div>
      <div class="Xnav-item-mnu"  data-dest="http://bunxious.com/store/purchase">My Purchases</div>
      <div class="Xnav-item-mnu"  data-dest="http://bunxious.com/settings/2190">My Settings</div>
      <div class="Xnav-item-mnu"  data-dest="http://bunxious.com/cart">My Subscriptions</div>
      <br>
      <hr>
      <br>
      <div class="Xnav-item"  data-dest="http://bunxious.com/user/group/2190/Stectech">My Groups</div>
      <div class="Xnav-item"  data-dest="http://bunxious.com/user/pin/2190/Stectech">My Items</div>
      <div class="Xnav-item-mnu"  data-dest="http://bunxious.com/store/sale">My Sales</div>
      <div class="Xnav-item-mnu"  data-dest="http://bunxious.com/store/settings/">Closet Settings</div>
      <br>
      <hr>
      <br>
      <div class="Xnav-item-mnu"  data-dest="http://bunxious.com/store/uploadpin/">Add New Product</div>
      <div class="Xnav-item"  data-dest="http://bunxious.com/store">My Closet</div>

    </div>
  </nav>
</div>

</body>
<script type="text/javascript">
  
  //Once the document has loaded...
  $(function(){

    //Bind click events to the hamburger.
    //User the fastClick event for more native response
    $('.toggleWrap').fastClick(function(e)
    {
      //prevent event 'bubble through' -- this is likely not necessary
      e.preventDefault();e.stopImmediatePropagation();
      
      onclick_togglebutton();
    });


    //Bind click events to the menu items.
    //User the fastClick event for more native response
    $('.nav-item').fastClick(function(e)
    {
      //prevent event 'bubble through' -- this is likely not necessary
      e.preventDefault();e.stopImmediatePropagation();
      
      onclick_togglebutton();
      
      //fetch the data-dest attribute from the menu item, and assign it to the 'src' attribute for the iFrame
      $('#mainview iframe').attr('src', this.getAttribute("data-dest"));
      
      //at one point adding a delay to setting the iframe styles was neccessarry, it may be superflous at this point
      setTimeout(function() {
        //make sure the iFrame is at the proper width for the app and can scroll.
        $('#mainview iframe').attr('style', "width:320px; margin-top: 0px; height:100%");
      }, 500);
    });


    //This also binds menu items as per the code directly above
    $('.nav-item-mnu').fastClick(function(e)
    {
      //the difference with the nav-item-mnu class items is that the iframe is adusted to display the content 600px from the top
      //this was done in order to not show the drop-down menu from the external web content for certain pages.  It should probably be
      //addressed instead via css on the server
      $('#mainview iframe').attr('style', "width:320px; margin-top: -600px; height:100%");
      e.preventDefault();e.stopImmediatePropagation();
      onclick_togglebutton();
      $('#mainview iframe').attr('src', this.getAttribute("data-dest"));
    });


    //this helps the iFrame scroll
    if (/iPhone|iPod|iPad/.test(navigator.userAgent))
      $('#mainview iframe').wrap(function(){
        var $this = $(this);
        return $('<div />').css({
          width: '100%',//$this.attr('width'),
          height: '100%',//$this.attr('3569px'),
          overflow: 'scroll',
          '-webkit-overflow-scrolling': 'touch'
        });
      });
  })
</script>

</html>
